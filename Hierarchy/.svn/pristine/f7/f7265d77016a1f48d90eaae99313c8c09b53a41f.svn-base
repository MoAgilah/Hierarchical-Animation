#include "BulletPool.h"

BulletPool::BulletPool()
{
	p_Bullet = CommonMesh::LoadFromXFile(Application::s_pApp, "Resources/Plane/bullet.x");

	for (unsigned int i = 0; i < MaxBullet; ++i)
	{
		bullets.push_back(new Bullet(p_Bullet));
	}
}

BulletPool::~BulletPool()
{
	for (unsigned int i = 0; i < bullets.size(); ++i)
	{
		delete bullets[i];
	}
	delete p_Bullet;
}

void BulletPool::Create(const XMMATRIX& gunMatrix, const XMVECTOR& Direction)
{
	for (unsigned int i = 0; i < MaxBullet; i++)
	{
		if (!bullets[i]->GetActive())
		{
			bullets[i]->Activate(gunMatrix, Direction);
			break;
		}
	}
}

void BulletPool::Update(const double& deltaTime)
{
	for (unsigned int i = 0; i < MaxBullet; ++i)
	{
		if (bullets[i]->GetActive())
		{
			if (bullets[i]->Update(deltaTime))
			{
              	bullets[i]->Deactivate();
			}
		}
	}
}

void BulletPool::Draw()
{
	for (unsigned int i = 0; i < MaxBullet; ++i)
	{
		if (bullets[i]->GetActive())
		{
			bullets[i]->Draw();
		}
	}
}